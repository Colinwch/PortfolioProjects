---
title: "Google Data Analytics Capstone Project"
author: "Colin Wong"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
  word_document:
    toc: yes
---

```{=html}
<style>
body {
  font-family: Calibri, Calibri;
}
</style>
```
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Summary

I worked on the Google Data Analytics Capstone Project - How Does a Bike-Share Navigate Speedy Success ?. I am using R Markdown to document my process of using tools like Microsoft Excel, Google Big Query and tableau to perform data cleaning, analysis, and visualization tasks. Ultimately, I will present business recommendations based on the analysis performed.

Quick Links: [Data Source](https://divvy-tripdata.s3.amazonaws.com/index.html) \|

### Background

I am a junior analyst at a Bike rental company called *Cyclistic*. The company has grown a fleet of 5824 bicycles that are geotracked and locked into a network of 692 stations across Chicago. The bikes can be unlocked from one station and returned to any other one. The company offers three pricing plans: single-ride passes, full-day passes and annual memberships. Customers who purchase single-ride or full-day passes are referred to as casual riders. Customers who purchase annual memberships are *Cyclistic* members. *Cyclistic's* finance analysts have concluded that annual members are much more profitable than casual riders.

### Goal

Design marketing strategies aimed at converting casual riders into annual members.

### Business task

To understand the question - "How do annual members and casual riders use Cyclistic bikes differently?" and to provide recommendations after analysing the data.

### Data Source

*Cyclistic's* monthly historical trip data in 2022 will be used to analyse and identify trends.

Data Source:[(https://divvy-tripdata.s3.amazonaws.com/index.html)](https://divvy-tripdata.s3.amazonaws.com/index.html)

### Microsoft Excel - Data Cleaning

I plan to use Microsoft Excel to prepare and clean the data before conducting the analysis. I have downloaded the 12 trip data files for 2022, each excel files contains trip data for one single month.

![](Screenshot/data%20.png)

For each excel csv file, I have performed below action:

(As the file formatting for all files are the same, I will be using VBA macros function in Excel to automate part of the cleaning process for all the Excel files. I will first record a macro while manually performing the cleaning steps on the initial Excel file. Subsequently, I can apply the recorded macro to the remaining files to execute the same set of cleaning operations. This approach ensures consistency in the formatting and automation of the cleaning process across all Excel files.)

1.  To narrow down my analysis, I will exclude unrelated columns and retain only "rideable_type," "started_at," "ended_at," and "member_casual."

2.  I will generate a new column called "ride_length" by subtracting the "started_at" column from the "ended_at" column in each cell. The result will be formatted as HH:MM:SS using the format cell function.

3.  Adding two new columns, "started_at_day_of_week" and "ended_at_day_of_week,". For each cell, the formula "=weekday(cell(started_at/ended_at),1)" will be applied to determine the day of the week.

4.  Adding a new column named "month" . The formula "=month(cell(started_at))" will be applied to each cell to extract the month.

5.  Adding four new columns, namely "started_date," "ended_date," "started_time," and "ended_time," . Each cell will be transformed to the corresponding date/hour format from the "started_at"/"ended_at" column values, respectively.

6.  Applying the replace function to substitute the values in the "started_at_day_of_week"/"ended_at_day_of_week" columns from 1-7 with Monday-Sunday. Additionally, the values in the "month" column will be replaced from 1-12 with January-December.

7.  Finally, by using filtering and conditional formatting functions I will identify and eliminate errors, and use duplicate removal function to eliminate duplicated values, and subsequently save the CSV file.

### Microsoft Excel (Power Query/Pivot tables) - Data Analysis

With a total of over 5 million rows, it is not feasible to merge the cleaned files into a single Excel file. Therefore, I am using Excel Power Query to combine the tables, and use pivot tables to analyse the cleaned data. With this process, I have made some initial observations of the data set and generated some ideas on what graphs I will be using in my final data visualisation dashboard.

![](Screenshot/1.png)

![](Screenshot/2.png)

![](Screenshot/number%20of%20trips%20per%20month.png)

![](Screenshot/membership%20type.png)

![](Screenshot/Total%20trips%20per%20day%20of%20week.png)

![](Screenshot/Type%20of%20bike%20usage.png)

### Google BigQuery (SQL)

The Excel Power Query Table could not be directly exported to Tableau, I will be using Google cloud BigQuery to join the tables for further data visualisation processes.

I have uploaded all the cleaned csv files to BigQuery and used the UNION ALL syntax to merge all the tables from January to December.

![](Screenshot/bigquery.png)

![](Screenshot/bigquery%202.png)

### Tableau - Data Visualisation

I connected the cleaned and merged data in BigQuery to Tableau with the intention of visualising it. Similar to the excel graphs I have created, I have created visuals in Tableau to compare how annual members and casual riders use Cyclistic bikes differently.

Membership type distribution

![](Screenshot/membership%20type.png)

Bike type usage by membership

![](Screenshot/bike%20type.png)

Trips per month

![](Screenshot/trips%20per%20month.png)

Trips per day of month

![](Screenshot/trips%20per%20day%20of%20month.png)

Trips per day of week

![](Screenshot/trips%20per%20day%20of%20week%20by%20membership%20type.png)

Trips per hour of day

![](Screenshot/trips%20bike%20rent%20starting%20hour%20by%20membership%20type.png)

### Dashboard

![](Screenshot/Dashboard.png)

### Final Summary

-   Out of all trips (roughly 5.5 million in total) in 2022, 40.97% were casual users.

-   The busiest months were June, July and August (Summer season) for both membership types.

-   The busiest days of week were Friday, Saturday and Sunday (Weekends) for both membership types.

-   Casual riders used the service the most on Sundays.

-   Peak hour of day was 5 PM for both membership types. Services were most popular in the afternoon.

-   The most popular bike type was electric bike.

### Recommendation

Below are the recommendations for the marketing team to convert casual riders to annual members:

1.  Emphasise the long term health benefits and cost saving benefits of having an annual membership over single-ride or full-day passes.

2.  Run targeted advertisements on Sundays and peak months like June, July, August, when casual riders are more active and are more likely to make the conversion.

3.  Offering prioritization for bicycle selection during busy hours and high demand seasons.
